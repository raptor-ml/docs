<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/concepts/aggregations" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Aggregations | Raptor</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://raptor.ml/docs/concepts/aggregations"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="raptor-ml, raptor, ml, machine learning, feature store, operational model, mlops, productization, deployment, data science, data engineering, data pipeline, prediction, inference, concepts, model serving, tabular data, time series, kubernetes, research, feature engineering, feature selection, feature extraction, feature transformation, feature aggregation, feature generation, feature enrichment, feature validation, devops, data ops, data science ops, data engineering ops, data science platform, data engineering platform, feature engineering platform, online, real-time, batch, offline, scalability, sagemaker, feast, feathr, mlflow, kubeflow, docker, backend, production, production-ready"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Aggregations | Raptor"><meta data-rh="true" name="description" content="Aggregations are probably the most complex challenge while building a production-grade feature,"><meta data-rh="true" property="og:description" content="Aggregations are probably the most complex challenge while building a production-grade feature,"><link data-rh="true" rel="icon" href="/img/icon.svg"><link data-rh="true" rel="canonical" href="https://raptor.ml/docs/concepts/aggregations"><link data-rh="true" rel="alternate" href="https://raptor.ml/docs/concepts/aggregations" hreflang="en"><link data-rh="true" rel="alternate" href="https://raptor.ml/docs/concepts/aggregations" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://MPWPX5FK2F-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Raptor RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Raptor Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Raptor" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.9cd43e0b.css">
<script src="/assets/js/runtime~main.7fad8cbc.js" defer="defer"></script>
<script src="/assets/js/main.31e608fa.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_IQ7Y" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Raptor" class="themedComponent_WVAU themedComponent--light_pwNk"><img src="/img/logo.svg" alt="Raptor" class="themedComponent_WVAU themedComponent--dark_ccPD"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/reference">Reference</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/community">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/raptor-ml/raptor" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Pq3K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_HD8j colorModeToggle_nBwH"><button class="clean-btn toggleButton_f_iu toggleButtonDisabled_filq" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_fcP2"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_boxm"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Abj0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_N6jd"><div class="docsWrapper_rftI"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_DQHh" type="button"></button><div class="docRoot_DRI8"><aside class="theme-doc-sidebar-container docSidebarContainer_s_dS"><div class="sidebarViewport_xBSW"><div class="sidebar_Bxsn"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_ClB3"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/getting-started-ipynb">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item concepts"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/concepts">Core Concepts</a><button aria-label="Collapse sidebar category &#x27;Core Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/mindset">The production mindset</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/basics">The basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/datasources">Data Sources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/concepts/aggregations">Aggregations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/sourceless">Sourceless features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/derived">Derived feature (like &quot;join&quot;)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/models">Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/concepts/common">Common use-cases</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/how-it-works">How does Raptor Work?</a><button aria-label="Expand sidebar category &#x27;How does Raptor Work?&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed prod"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/production">Production</a><button aria-label="Expand sidebar category &#x27;Production&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/troubleshooting">Troubleshooting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/community">Join the community</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://github.com/raptor-ml/raptor" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_Rr7L">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Pq3K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer__at7"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z48u"><div class="docItemContainer_NhG4"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_lHJE" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_jTI1"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/concepts"><span itemprop="name">Core Concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Aggregations</span><meta itemprop="position" content="2"></li></ul></nav><div class="theme-doc-markdown markdown"><p>Aggregations are probably the most complex challenge while building a production-grade feature,
they require a <a href="/docs/how-it-works/features/aggregations">special mechanism</a> to handle the data in
production, but are relatively easy to implement in development.</p>
<p>Fortunately, it&#x27;s relatively easy to build aggregations in Raptor.</p>
<h1>Rolling window aggregations</h1>
<p>Aggregations are usually being calculated on a rolling window, I.e. The amount of clicks over the last hour.</p>
<p>We can achieve that by using the <a href="/reference/labsdk/decorators#aggregation"><code>@aggregation</code></a> decorator.</p>
<div class="language-python codeBlockContainer_bh35 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_IV1l"><pre tabindex="0" class="prism-code language-python codeBlock_pzEv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FQf7 codeBlockLinesWithNumbering_NckF"><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token decorator annotation punctuation" style="color:#393A34">@feature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;user_id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_source</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Click</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@aggregation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    function</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">AggregationFunction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    over</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;10h&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    granularity</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1m&#x27;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">clicks</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">this_row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Click</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">int</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;clicks over 10 hours&quot;&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span></span><br></span></code></pre><div class="buttonGroup_LEvy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_hLaz" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_qgfY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_trg8"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Pretty simple right? let&#x27;s go through what we did here line by line:</p>
<ol>
<li>
<p>We registered the feature with the <a href="/reference/labsdk/decorators#feature"><code>@feature</code></a> decorator.</p>
</li>
<li>
<p>We defined the aggregation function with the <a href="/reference/labsdk/decorators#aggregation"><code>@aggregation</code></a> decorator.</p>
<ol>
<li>We set the aggregation function to be <code>count</code>.</li>
<li>We set the rolling window to be 10 hours.</li>
<li>We set the granularity to be 1 minute.</li>
</ol>
</li>
<li>
<p>We defined the feature function, which is a simple function that returns 1.
This is because we&#x27;re counting the number of clicks, so we don&#x27;t need to do any calculations.</p>
<p>This will actually count the number of clicks over the last 10 hours, and will return the number of clicks.</p>
</li>
</ol>
<h1>Aggregation functions</h1>
<p>Now that we know how to build aggregations, let&#x27;s go ahead and build a feature that have multiple aggregation functions.</p>
<div class="language-python codeBlockContainer_bh35 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_IV1l"><pre tabindex="0" class="prism-code language-python codeBlock_pzEv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FQf7 codeBlockLinesWithNumbering_NckF"><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token decorator annotation punctuation" style="color:#393A34">@feature</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;account_id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data_source</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">Deal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token decorator annotation punctuation" style="color:#393A34">@aggregation</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    function</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">AggregationFunction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Sum</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> AggregationFunction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Avg</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> AggregationFunction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Max</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> AggregationFunction</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Min</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    over</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;10h&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    granularity</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;1m&#x27;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">deals_10h</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">this_row</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Deal</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ctx</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Context</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;sum/avg/min/max of deal amount over 10 hours&quot;&quot;&quot;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> this_row</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;amount&#x27;</span><span class="token punctuation" style="color:#393A34">]</span></span><br></span></code></pre><div class="buttonGroup_LEvy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_hLaz" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_qgfY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_trg8"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, we&#x27;re building a feature that is calculating the sum, average, maximum and minimum of the deal amount.</p>
<p>This is actually generating for us multiple features, one for each aggregation function.
We can access them by specifying the aggregation function in the Feature Selector:</p>
<div class="language-python codeBlockContainer_bh35 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_IV1l"><pre tabindex="0" class="prism-code language-python codeBlock_pzEv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_FQf7 codeBlockLinesWithNumbering_NckF"><span class="token-line codeLine_Sb0u" style="color:#393A34"><span class="codeLineNumber_j1zn"></span><span class="codeLineContent_joL5"><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">feature_get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;default.deals_10h+sum&quot;</span><span class="token punctuation" style="color:#393A34">)</span></span><br></span></code></pre><div class="buttonGroup_LEvy"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_hLaz" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_qgfY"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_trg8"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/raptor-ml/docs/tree/master/docs/docs/concepts/3-aggregations.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_qz4j" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_rxti"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/concepts/datasources"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Data Sources</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/concepts/sourceless"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sourceless features</div></a></nav></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started-ipynb">Getting started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/concepts">Core concepts</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/how-it-works">How does Raptor work?</a></li></ul></div><div class="col footer__col"><div class="footer__title">Reference</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/reference">Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/reference/labsdk/decorators">LabSDK decorators</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/community">Slack community</a></li><li class="footer__item"><a href="https://twitter.com/RaptorML" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Pq3K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/raptor-ml/raptor" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_Pq3K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.svg" alt="Raptor" class="footer__logo themedComponent_WVAU themedComponent--light_pwNk" height="80"><img src="/img/logo.svg" alt="Raptor" class="footer__logo themedComponent_WVAU themedComponent--dark_ccPD" height="80"></div><div class="footer__copyright">Copyright Â© 2024 Raptor.</div></div></div></footer></div>
</body>
</html>